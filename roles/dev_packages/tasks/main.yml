---
# This role install basic packages for development
 - name: Install git
   apt: name=git

 - name: Install curl
   apt: name=curl

 - name: Install vim
   apt: name=vim
 - name: Create directory for vim colors
   file: path="{{homedir}}/.vim/colors/" state=directory
 - name: Install vim color scheme
   get_url: url=https://raw.githubusercontent.com/vim-scripts/256-jungle/master/colors/256-jungle.vim dest="{{ homedir }}/.vim/colors/256-jungle.vim"

 - name: Install gcc-4.8
   apt: name=gcc-4.8
 - name: Update alternatives gcc
   alternatives: name=gcc path=/usr/bin/gcc-4.8 link=/usr/bin/gcc

 - name: Install g++-4.8
   apt: name=g++-4.8
 - name: Update alternatives g++
   alternatives: name=g++ path=/usr/bin/g++-4.8 link=/usr/bin/g++

 - name: Install cmake
   apt: name=cmake

 - name: Add java repository
   apt_repository: repo=ppa:webupd8team/java
 - name: Agree with oracle license
   shell: "{{ playbook_dir }}/roles/dev_packages/scripts/oracle-licence.sh oracle-java8-installer" 
   changed_when: False
 - name: Install java 8
   apt: name=oracle-java8-installer
 - name: Set java defaults
   apt: name=oracle-java8-set-default

 - name: Install maven
   apt: name=maven
 - name: Install gradle
   apt: name=gradle

 - name: Install zsh
   apt: name=zsh
 - name: Install oh-my-zsh
   shell: "{{ playbook_dir }}/roles/dev_packages/scripts/install-oh-my-zsh.sh {{ homedir }} {{ username }}" 
   changed_when: False
 - name: Install Source Code Pro font
   copy: src="{{ playbook_dir }}/roles/dev_packages/resources/SourceCodeProFonts" dest="/usr/share/fonts"
 - name: Install powerline9k theme
   git: clone=yes repo=https://github.com/bhilburn/powerlevel9k.git dest="{{ homedir }}/.oh-my-zsh/custom/themes/powerlevel9k"  

 - name: Install docker deps 1/4
   apt: name=apt-transport-https
 - name: Install docker deps 2/4
   apt:  name=ca-certificates
 - name: Install docker deps 3/4
   apt: name=curl
 - name: Install docker deps 4/4
   apt: name=software-properties-common
 - name: Add docker PGP key
   shell: curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
   changed_when: False
 - name: Add docker repository
   apt_repository: repo="deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ubuntu }}  stable"
 - name: Install docker
   apt: name=docker-ce
 - name: Create docker group
   group: name=docker state=present system=yes
 - name: Add user to docker group
   user: name="{{ username }}" group=docker
 - name: Enable docker to start on boot
   systemd: name=docker enabled=yes state=started
 - name: Install docker-compose
   shell: "{{ playbook_dir }}/roles/dev_packages/scripts/install-docker-compose.sh" 
   changed_when: False
 - name: Give execution permissions to binary
   file: path=/usr/local/bin/docker-compose mode=777
 - name: Create directory for zsh completions
   file: path="{{homedir}}/.oh-my-zsh/completion/" state=directory
 - name: Install docker-compose zsh autocompletion
   shell: "{{ playbook_dir }}/roles/dev_packages/scripts/install-docker-compose-autocompletion.sh {{ homedir }}" 
   changed_when: False
   
